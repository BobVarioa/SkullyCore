(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?module.exports=b():"function"==typeof define&&define.amd?define(b):(a="undefined"==typeof globalThis?a||self:globalThis,a.SkullyCore=b())})(this,function(){'use strict';function a(a){var b=document.createElement("div");return b.innerHTML=a.trim(),b.firstChild}function b(a){return`${"undefined"!=typeof a[2]&&""!==a[2]?"background-image:url("+a[2]+");":""}background-position:${48*-a[0]}px ${48*-a[1]}px;`}var c="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis,d=function(a,b){return b={exports:{}},a(b,b.exports),b.exports}(function(a){(function(b,c){a.exports=c()})(c,function(){function aa(a,b){function c(){this.constructor=a}P(a,b),a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)}function ba(b,c,d,f){return new(d||(d=Promise))(function(g,a){function h(b){try{j(f.next(b))}catch(b){a(b)}}function i(b){try{j(f["throw"](b))}catch(b){a(b)}}function j(a){a.done?g(a.value):new d(function(b){b(a.value)}).then(h,i)}j((f=f.apply(b,c||[])).next())})}function ca(b,e){function f(a){return function(b){return g([a,b])}}function g(a){if(h)throw new TypeError("Generator is already executing.");for(;m;)try{if(h=1,j&&(k=2&a[0]?j["return"]:a[0]?j["throw"]||((k=j["return"])&&k.call(j),0):j.next)&&!(k=k.call(j,a[1])).done)return k;switch((j=0,k)&&(a=[2&a[0],k.value]),a[0]){case 0:case 1:k=a;break;case 4:return m.label++,{value:a[1],done:!1};case 5:m.label++,j=a[1],a=[0];continue;case 7:a=m.ops.pop(),m.trys.pop();continue;default:if((k=m.trys,!(k=0<k.length&&k[k.length-1]))&&(6===a[0]||2===a[0])){m=0;continue}if(3===a[0]&&(!k||a[1]>k[0]&&a[1]<k[3])){m.label=a[1];break}if(6===a[0]&&m.label<k[1]){m.label=k[1],k=a;break}if(k&&m.label<k[2]){m.label=k[2],m.ops.push(a);break}k[2]&&m.ops.pop(),m.trys.pop();continue;}a=e.call(b,m)}catch(b){a=[6,b],j=0}finally{h=k=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}var h,j,k,i,m={label:0,sent:function(){if(1&k[0])throw k[1];return k[1]},trys:[],ops:[]};return i={next:f(0),throw:f(1),return:f(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i}function da(){for(var b=0,f=0,g=arguments.length;f<g;f++)b+=arguments[f].length;for(var h=Array(b),i=0,f=0;f<g;f++)for(var j=arguments[f],d=0,k=j.length;d<k;d++,i++)h[i]=j[d];return h}function ea(a){return a.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function a(b,c){var d=null===c[0],f=/(?:)/;null!==c[0]&&(f="string"==typeof c[0]?new RegExp(ea(c[0]),"g"):c[0],!f.test(b)&&console.warn("Nothing to inject."));var g=/(\)[^{]*{)/,a=/(}?)$/;switch(c[2]){case"before":b=d?b.replace(g,"$1"+c[1]):b.replace(f,""+c[1]+c[0]);break;case"replace":b=d?c[1]:b.replace(f,c[1]);break;case"after":b=d?b.replace(a,c[1]+"$1"):b.replace(f,""+c[0]+c[1]);break;default:throw new Error("where Parameter must be \"before\", \"replace\" or \"after\"");}return b}function o(b,c,d,e,f){void 0===f&&(f={});var g=Function.apply(void 0,da(Object.keys(f),["return ("+a(b.toString(),[c,d,e])+")"])).apply(void 0,Object.values(f));return g.prototype=b.prototype,g}function r(b,e,f){void 0===f&&(f={});for(var g,h=b.toString(),j=0,k=e;j<k.length;j++)g=k[j],h=a(h,g);var d=Function.apply(void 0,da(Object.keys(f),["return ("+h+")"])).apply(void 0,Object.values(f));return d.prototype=b.prototype,d}function fa(a,b){for(var c in b)a[c]=b[c]}function c(a){return a.charAt(0).toUpperCase()+a.slice(1).toLowerCase()}function u(a,b){return a.hasOwnProperty(b)}function d(b){for(var c,d=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]],f="",g=0,h=d;g<h.length;g++)for(c=h[g];b>=c[0];)f+=c[1],b-=c[0];return f}function g(a){switch(a){case"mod":return{achievements:{},buildings:{},upgrades:{}};case"dragon":return{level:"sync",auras:["sync","sync"]};case"achievement":return{won:!1};case"upgrade":return{bought:!1,unlocked:!1};case"building":return{amount:0,bought:0,free:0,totalCookies:0,level:0,muted:0,minigameSave:""};default:throw new Error("Invalid fragment name!");}}function m(){return{mods:{},foreign:g("mod"),saveVer:1,dragon:g("dragon")}}function i(){Ka.save=U=m()}function ga(a){return U.foreign.buildings[a.name]||g("building")}function b(b){var c=b.amount,e=b.bought,f=b.free,g=b.totalCookies,a=b.level,h=b.muted,i=b.minigameSave,j=b.name;U.foreign.buildings[j]={amount:c,bought:e,free:f,totalCookies:g,level:a,muted:h,minigameSave:i}}function h(a){return U.foreign.upgrades[a.name]||g("upgrade")}function e(a){U.foreign.upgrades[a.name]={unlocked:!!a.unlocked,bought:!!a.bought}}function f(a){return U.foreign.achievements[a.name]||g("achievement")}function k(a){U.foreign.achievements[a.name]={won:!!a.won}}function p(){"sync"!==U.dragon.level&&U.dragon.level<=Game.dragonLevels.length-1&&(Game.dragonLevel=U.dragon.level),"sync"!==U.dragon.auras[0]&&U.dragon.auras[0]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura=U.dragon.auras[0]),"sync"!==U.dragon.auras[1]&&U.dragon.auras[1]<=Object.keys(Game.dragonAuras).length-1&&(Game.dragonAura2=U.dragon.auras[1])}function s(){for(var b,c=0,g=Ka.customBuildings;c<g.length;c++)b=g[c],fa(b,ga(b));for(var i,j=0,k=Ka.customUpgrades;j<k.length;j++)i=k[j],fa(i,h(i)),i.bought&&Game.CountsAsUpgradeOwned(i.pool)&&Game.UpgradesOwned++;for(var m,q=0,r=Ka.customAchievements;q<r.length;q++)m=r[q],fa(m,f(m)),m.won&&Game.CountsAsAchievementOwned(m.pool)&&Game.AchievementsOwned++;p()}function n(){for(var c,f=0,g=Ka.customBuildings;f<g.length;f++)c=g[f],b(c);for(var h,i=0,j=Ka.customUpgrades;i<j.length;i++)h=j[i],e(h);for(var m,p=0,q=Ka.customAchievements;p<q.length;p++)m=q[p],k(m)}function t(a){var b=m();if("object"!=typeof a||null===a)return b;if(!u(a,"saveVer")||"number"!=typeof a.saveVer||1<a.saveVer)return b;if(b.foreign=u(a,"foreign")?function(b){var c=g("mod");if("object"!=typeof b||null===b)return c;if(u(b,"buildings")&&"object"==typeof b.buildings&&null!==b.buildings)for(var e in b.buildings){var f=b.buildings[e];if("object"==typeof f&&null!==f)for(var h in c.buildings[e]=g("building"),f)typeof c.buildings[e][h]==typeof f[h]&&(c.buildings[e][h]=f[h])}if(u(b,"upgrades")&&"object"==typeof b.upgrades&&null!==b.upgrades)for(var i in b.upgrades){var j=b.upgrades[i];if("object"==typeof j&&null!==j)for(var h in c.upgrades[i]=g("upgrade"),c.upgrades[i])typeof c.upgrades[i][h]==typeof j[h]&&(c.upgrades[i][h]=j[h])}if(u(b,"achievements")&&"object"==typeof b.achievements&&null!==b.achievements)for(var k in b.achievements){var m=b.achievements[k];if("object"==typeof m&&null!==m)for(var h in c.achievements[k]=g("achievement"),c.achievements[k])typeof c.achievements[k][h]==typeof m[h]&&(c.achievements[k][h]=m[h])}return c}(a.foreign):g("mod"),u(a,"dragon")&&"object"==typeof a.dragon&&null!==a.dragon&&(u(a.dragon,"level")&&("number"==typeof a.dragon.level||"sync"===a.dragon.level)&&(b.dragon.level=a.dragon.level),u(a.dragon,"auras")&&a.dragon.auras instanceof Array))for(var c in a.dragon.auras){var d=a.dragon.auras[c];("number"==typeof d||"sync"===d)&&(b.dragon.auras[c]=d)}return b}function j(a){var b;try{b=JSON.parse(a)}catch(b){""!==a&&console.warn("CPPKIES: Found invalid save, creating new one..."),i()}U=Ka.save=t(b),s()}function v(){return n(),JSON.stringify(U)}function w(a,b){V[a]=b}function y(a){if(X.includes(a))throw new Error("Recursive alias");return(X.push(a),a in V)?y(V[a]):(X=[],a)}function A(a){return new Promise(function(b){var c=new Image;c.addEventListener("load",function(){b(c)}),c.crossOrigin="Anonymous",c.src=a})}function I(a){return new Promise(function(b){a.canvas.toBlob(function(a){b(URL.createObjectURL(a))})})}function C(b,f,e,c,d,a){return new Promise(function(g){e[0]instanceof Array||(e=[e]),e=e;var h={};for(var i in e)for(var j in e[i])if(e[i][j]){if(e[i][j]=e[i][j].toString().toLowerCase(),!(e[i][j]in f))throw new Error("Invalid icon name");h[e[i][j]]=[parseInt(j),parseInt(i)]}var k=document.createElement("canvas").getContext("2d"),m=new Image;m.addEventListener("load",function(){for(var b in k.canvas.width=d[0],k.canvas.height=d[1],h)k.drawImage(m,h[b][0]*c[0],h[b][1]*c[1],c[0],c[1],f[b][0]*c[0],f[b][1]*c[1],c[0],c[1]);var e,j=function(){I(k).then(g)};a&&(e=a(k)),e instanceof Promise?e.then(j):j()}),m.crossOrigin="Anonymous",m.src=b})}function G(a){return a=da(a),(void 0===a[2]||null===a[2])&&(a[2]=Ka.iconLink),a[2]=y(a[2]),a}function L(a){var b=new R,c=[new S("tooltip",function(){a.tooltip=o(o(a.tooltip,"return","let tempRet = ","replace"),null,"\n//Cppkies injection\n\t\t\t\treturn Cppkies.buildingHooks[this.name].emit(\"tooltip\", tempRet)","after")}),new S("buy",function(){a.buy=o(a.buy,null,"\n//Cppkies injection\n\t\t\t\tif(success) {\n\t\t\t\t\tCppkies.buildingHooks[this.name].emit(\"buy\")\n\t\t\t\t}","after")}),new S("levelUp",function(){a.levelUp=o(a.levelUp,"me.level+=1;","\n// Cppkies injection\nCppkies.buildingHooks[me.name].emit(\"levelUp\")","after",{me:a})})];c.forEach(function(a){var b;null===(b=a.func)||void 0===b?void 0:b.call(a)}),Ka.hooks.on("buildingCps",function(c){return{building:c.building,cps:Game.Objects[c.building]===a?b.emit("cps",c.cps):c.cps}}),_[a.name]=b}function B(){for(var a,b=0,c=Game.ObjectsById;b<c.length;b++)a=c[b],_[a.name]||L(a)}function M(a){return"fortune"===a.tier}function q(b){for(var c,d=1,e=1;e<=b;e++)d+=null!==(c=ra[e])&&void 0!==c?c:ra["default"];return 9*H(10,d)}function E(){Ka.on("getIcon",function(a){var b=a.icon,c=a.type,d=a.tier;return Ka.customTiers.forEach(function(a){a.keyName===d.toString()&&a.iconLink&&(b[2]=a.iconLink)}),{icon:b,type:c,tier:d}}),Ka.on("getIcon",function(a){var b=a.icon,c=a.type,d=a.tier;return Ka.customBuildings.forEach(function(a){a.name===c&&a.iconLink&&(b[2]=a.iconLink)}),{icon:b,tier:d,type:c}}),Ka.on("getIcon",function(a){var b=a.icon,c=a.type,d=a.tier;return void 0!==b[2]&&null!==b[2]||u(Game.Tiers[d.toString()],"iconLink")||(b[2]=""),{icon:b,tier:d,type:c}}),Ka.on("preSave",function(){if(0!==Game.dragonAura&&(U.dragon.auras[0]="sync"),0!==Game.dragonAura2&&(U.dragon.auras[1]="sync"),Game.dragonAuras[Game.dragonAura]instanceof Ga&&(U.dragon.auras[0]=Game.dragonAura,Game.dragonAura=0),Game.dragonAuras[Game.dragonAura2]instanceof Ga&&(U.dragon.auras[1]=Game.dragonAura2,Game.dragonAura2=0),Game.dragonLevels[Game.dragonLevel]instanceof Ha||Game.dragonLevel>=T)for(U.dragon.level=Game.dragonLevel;Game.dragonLevels[Game.dragonLevel]instanceof Ha||Game.dragonLevel>=T;)Game.dragonLevel--}),Ka.on("postSave",function(){"sync"!==U.dragon.auras[0]&&Game.dragonAuras[U.dragon.auras[0]]&&(Game.dragonAura=U.dragon.auras[0]),"sync"!==U.dragon.auras[1]&&Game.dragonAuras[U.dragon.auras[1]]&&(Game.dragonAura2=U.dragon.auras[1]),"sync"!==U.dragon.level&&Game.dragonLevels[U.dragon.level]&&(Game.dragonLevel=U.dragon.level)}),Ka.on("reset",function(){U.dragon.auras=["sync","sync"],U.dragon.level="sync"}),Ka.on("specialPic",function(a){var b,c=Game.dragonLevels[Game.dragonLevel];return"dragon"===a.tab&&c instanceof Ha&&(a.pic=null!==(b=c.picLink)&&void 0!==b?b:a.pic),a})}var x,N=Math.abs,O=Math.floor,F=Math.min,H=Math.pow,D=Math.max,P=function(a,b){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])},P(a,b)},R=function(){function a(){this._events={}}return a.prototype.on=function(a,b){this._events[a]?this._events[a].push(b):this._events[a]=[b]},a.prototype.once=function(a,b){var c=this;this.on(a,function(d){return c.off(a,b),b(d)})},a.prototype.off=function(a,b){this._events[a].splice(this._events[a].indexOf(b),1)},a.prototype.emit=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];var e=c[0];this._events[b]||(this._events[b]=[]);for(var f,g=0,h=this._events[b];g<h.length;g++)f=h[g],e=f(e);return e},a.prototype.constEmit=function(b){for(var c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];this._events[b]||(this._events[b]=[]);for(var e,f=0,g=this._events[b];f<g.length;f++)e=g[f],e(c[0])},a}(),S=function(){return function(a,b){this.value=a,this.func=b}}(),T=Game.dragonLevels.length+0,U=m(),V={},X=[],Y={},z={"3d":[0,21],milestone1:[0,22],milestone2:[0,23],milestone3:[0,24],krumblor:[0,25],level1:[0,26],level2:[0,27]},Z={},$={research:[9,0],cookie:[10,0],mouse:[11,0],multicursor:[12,0],kitten:[18,0]},_={},ha=[],ia=function(h){function a(i,e,j,a,n,o,q,d,c,r){var p,s,t=this;if(Game.Objects[i])throw new Error("Can't create building, \""+i+"\" is already used as a building name");0!==a[1]&&console.warn("All icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=relink-column"),0!==n[0]&&console.warn("All big icon sheets must follow an order, see https://cppkies.js.org/#/CommonProblems#IconOrder?id=big-icons"),t=h.call(this,i,e,j,n[1],a[0],o,0,q,d)||this,ha.push(t),_[i]||L(t);var u=function(a){if(0>=parseInt(a))return"continue";var b=Game.ObjectsById[a];if(b.canvas=l("rowCanvas"+a),!b.canvas)return"continue";if(b.ctx=b.canvas.getContext("2d"),b.canvas.addEventListener("mouseover",function(){b.mouseOn=!0}),b.canvas.addEventListener("mouseout",function(){b.mouseOn=!1}),b.canvas.addEventListener("mousemove",function(a){var c=b.canvas.getBoundingClientRect();b.mousePos[0]=a.pageX-c.left,b.mousePos[1]=a.pageY-c.top}),b.minigame&&b.minigameLoaded){var c=b.minigame.save();b.minigame.launch(),b.minigame.load(c)}};for(var b in Game.ObjectsById)u(b);t.buildingLink=null!==(p=n[2])&&void 0!==p?p:Ka.buildingLink,t.iconLink=y(null!==(s=a[2])&&void 0!==s?s:Ka.iconLink),c&&(Game.foolObjects[i]=c),r&&(Game.goldenCookieBuildingBuffs[i]=r),t.iconLink&&_[t.name].on("tooltip",function(a){return t.locked?a:a.replace("background-position","background-image:url("+t.iconLink+");background-position")}),Game.BuildStore(),t.buildingLink&&Ka.hooks.on("buildStore",function(){l("productIcon"+t.id).style.backgroundImage="url("+t.buildingLink+")",l("productIconOff"+t.id).style.backgroundImage="url("+t.buildingLink+")"}),Game.BuildStore(),t.canvas=l("rowCanvas"+t.id),t.ctx=t.canvas.getContext("2d"),t.pics=[];var w=document.createElement("div");w.className="tinyProductIcon",w.id="mutedProduct"+t.id,w.style.display="none",t.buildingLink&&(w.style.backgroundImage="url("+t.buildingLink+")"),w.style.backgroundPositionX="-"+a[0]+"px",w.style.backgroundPositionY="-"+a[1]+"px",w.addEventListener("click",function(){t.mute(0),window.PlaySound(t.muted?"snd/clickOff.mp3":"snd/clickOn.mp3")}),window.AddEvent(t.canvas,"mouseover",function(){t.mouseOn=!0}),window.AddEvent(t.canvas,"mouseout",function(){t.mouseOn=!1}),t.canvas.addEventListener("mousemove",function(a){var b=t.canvas.getBoundingClientRect();t.mousePos[0]=a.pageX-b.left,t.mousePos[1]=a.pageY-b.top}),l("buildingsMute").appendChild(w);var f=ga(t);for(var b in f)t[b]=f[b];return Game.recalculateGains=1,t}return aa(a,h),a}(Game.Object),ja=[],ka=function(b){function a(f,e,g,a,i){void 0===i&&(i=function(){});var j=b.call(this,f,"function"==typeof e?"":e,"function"==typeof g?0:g,"function"==typeof a?[0,0]:G(a),i)||this;"function"==typeof e&&(j.descFunc=e),"function"==typeof g&&(j.priceFunc=g),"function"==typeof a&&(j.iconFunction=function(){return G(a())}),ja.push(j);var k=h(j);for(var d in k)j[d]=k[d];return Game.upgradesToRebuild=1,j.bought&&Game.CountsAsUpgradeOwned(j.pool)&&Game.UpgradesOwned++,j}return aa(a,b),a}(Game.Upgrade),la=function(b){function a(c,e,f,g,a,h,i){void 0===h&&(h=["Legacy"]),void 0===i&&(i=function(){});var j=b.call(this,c,e,f,g,i)||this;return j.pool="prestige",j.posX=a[0],j.posY=a[1],j.parents=h.map(function(a){return Game.Upgrades[a]||Game.UpgradesById[a]}),Game.PrestigeUpgrades.push(j),Game.UpgradePositions[j.id]=a,j}return aa(a,b),a}(ka),ma=function(b){function a(d,e,f,g){var h=this;return"string"==typeof f&&(f=Game.Objects[f]),h=b.call(this,d,c(f.plural)+" are <b>twice</b> as efficient.<q>"+e+"</q>",f.basePrice*Game.Tiers[g].price,Game.GetIcon(f.name,g))||this,Game.SetTier(f.name,g),h.buildingTie1=f,M(h)&&(h.order=19e3,f.fortune=h),isNaN(parseInt(g.toString()))||(g=parseInt(g.toString())),"number"==typeof g&&(h.order=100*(f.id+1)+h.id/1e3,h.order-=75*D(0,F(f.id-4,3)),8<=f.id&&(h.order-=75)),"fortune"===g&&Game.Tiers[g].upgrades.push(h),f.buyFunction.apply(f),h}return aa(a,b),a}(ka),na=function(a){function b(b,d,e,f){var g=this;if(f){if(!f.endsWith(".png"))throw new Error("Can't use the grandma picture URL \""+f+"\", URL must end with .png");f=f.substring(0,f.length-4)}"string"==typeof e&&(e=Game.Objects[e]);var h=e.id-1;return 1===h?h="grandma":h+=" grandmas",g=a.call(this,b,"Grandmas are <b>twice</b> as efficient. "+c(e.plural)+" gain <b>+1% CpS</b> per "+h+".<q>"+d+"</q>",e.basePrice*Game.Tiers[2].price,[10,9,""],Game.Objects.Grandma.redraw)||this,e.grandma=g,g.buildingTie=e,g.order=250+g.id/1e3,12<=e.id&&(g.order+=5),Game.GrandmaSynergies.push(g.name),f&&Ka.hooks.on("grandmaPic",function(a){return g.bought?da(a,[f]):a}),Game.Objects.Grandma.redraw(),e.buyFunction.apply(e),g}return aa(b,a),b}(ka),oa=function(b){function a(f,e,g,h,i){var j=this;"string"==typeof g&&(g=Game.Objects[g]),"string"==typeof h&&(h=Game.Objects[h]);var k=Game.GetIcon(g.name,i);if(g.basePrice>h.basePrice){var m=g;g=h,h=m}return j=b.call(this,f,c(g.plural)+" gain <b>+5% CpS</b> per "+h.name.toLowerCase()+".<br>"+c(h.plural)+" gain <b>+0.1% CpS</b> per \n\t\t\t"+g.name.toLowerCase()+".<q>"+e+"</q>",(10*g.basePrice+1*h.basePrice)*Game.Tiers[i].price,k)||this,j.tier=i,j.buildingTie1=g,j.buildingTie2=h,j.order=5e3+j.id/1e3,g.synergies.push(j),h.synergies.push(j),Game.Tiers[i].upgrades.push(j),Game.RebuildUpgrades(),g.buyFunction.apply(g),j}return aa(a,b),a}(ka),pa=[5,7,8,9,10],qa=function(b){function a(c,d,e,f){void 0===f&&(f=20);var g=this,h=Game.Objects.Cursor,i=parseInt(e.toString());return g=b.call(this,c,"Multiplies the gain from Thousand fingers by <b>"+f+"</b>.<q>"+d+"</q>",Game.Tiers[e].special||isNaN(i)?h.basePrice*Game.Tiers[e].price:H(10,pa[F(i-4,pa.length-1)]+3*D(i-8,0)),Game.GetIcon(h.name,e))||this,g.tier=e,g.pool="",g.order=100+g.id/1e3,Ka.on("cursorFingerMult",function(a){return g.bought?a*f:a}),Game.Tiers[e].special||isNaN(i)||Ka.buildingHooks.Cursor.on("buy",function(){h.amount>=(4===i?25:50*(i-4))&&Game.Unlock(g.name)}),"fortune"===e&&Game.Tiers[e].upgrades.push(g),Game.Objects.Cursor.buyFunction.apply(Game.Objects.Cursor),g}return aa(a,b),a}(ka),ra={1:5,2:4,4:4,default:3},sa=[.1,.125,.15,.175,.2,.2,.2,.2,.2,.175,.15,.125,.115],ta=function(b){function a(c,d,e,f,g,h){void 0===f&&(f=Game.Tiers[e].special||isNaN(parseInt(e.toString()))?null:sa[(parseInt(e.toString())-1)%(sa.length-1)]),void 0===h&&(h=Game.Tiers[e].special||isNaN(parseInt(e.toString()))?null:1===e?.5:e-1);var i=b.call(this,c,"You gain <b>more CpS</b> the more milk you have.<q>"+d+"</q>",Game.Tiers[e].special||isNaN(parseInt(e.toString()))?null!==g&&void 0!==g?g:0:q(e),Game.GetIcon("Kitten",e))||this;return i.tier=e,i.kitten=!0,i.pool="",null===f&&console.warn("Please make sure to specify the power if the kitten tier is special"),(Game.Tiers[e].special||isNaN(parseInt(e.toString())))&&void 0===g&&console.warn("Please make sure to specify the cost if the kitten tier is special"),null!==h&&Ka.on("logic",function(){Game.milkProgress>=h&&Game.Unlock(i.name)}),i.order=2e4+i.id/1e3,null!==f&&Ka.on("rawCpsMult",function(a){var b=i.bought?1+Game.milkProgress*f*Ka.hiddenMilkMult:1;return Game.cookiesMultByType.kittens*=b,a*b}),Game.UpgradesByPool.kitten.push(i),"fortune"===e&&Game.Tiers[e].upgrades.push(i),i}return aa(a,b),a}(ka),ua=function(b){function a(c,d,e,f){void 0===f&&(f=1);var g=b.call(this,c,"Clicking gains <b>+"+f+"% of your CpS</b>.<q>"+d+"</q>",H(10,3+2*parseInt(e.toString())),Game.GetIcon("Mouse",e))||this;g.tier=e,g.pool="";var h=parseInt(e.toString());return g.order=150+g.id/1e3,Ka.on("cpcAdd",function(a){return g.bought?a+Game.cookiesPs*f/100:a}),Game.Tiers[e].special||isNaN(h)||Ka.on("check",function(){Game.handmadeCookies>=H(10,1+2*h)&&Game.Unlock(g.name)}),"fortune"===e&&Game.Tiers[e].upgrades.push(g),g}return aa(a,b),a}(ka),va=function(b){function a(f,e,g,h,a,i,j){var k,m=b.call(this,f,"Cookie production multiplier <b>+"+Beautify("function"==typeof a?a():a,1)+"%</b>.<q>"+e+"</q>",g,h)||this;return m.power=a,m.pool="cookie",m.order=(null!==(k=null!==j&&void 0!==j?j:Ka.cookieOrder)&&void 0!==k?k:10020)+m.id/1e3,m.unlockAt={name:f,cookies:("function"==typeof g?g():g)/20,require:null===i||void 0===i?void 0:i.require,season:null===i||void 0===i?void 0:i.season},Game.UnlockAt.push(m.unlockAt),Game.UpgradesByPool.cookie.push(m),Game.cookieUpgrades.push(m),m}return aa(a,b),a}(ka),wa=[],xa=function(){return function(b,e,f,g,h,i,j,k,m){void 0===g&&(g=!1),void 0===h&&(h="auto"),void 0===i&&(i=null),void 0===j&&(j=null),void 0===k&&(k=null),void 0===m&&(m="auto");var n;this.name=b,this.color=f,this.special=g,this.keyName="auto"===m?g?b:(Object.keys(Game.Tiers).filter(function(a){return!isNaN(parseInt(a))}).length+1).toString():m,null===i&&(this.unlock=-1),"number"==typeof i&&(this.unlock=i),(!1===g&&null===i||"auto"===i)&&(this.unlock=Game.Tiers[parseInt(this.keyName)-1].unlock+50),"number"==typeof j&&(this.achievUnlock=j),(!1===g&&null===j||"auto"===j)&&(this.achievUnlock=Game.Tiers[parseInt(this.keyName)-1].achievUnlock+50),k&&(this.req=k),this.price="auto"===h?1e8*Game.Tiers[Object.keys(Game.Tiers).filter(function(a){return!isNaN(parseInt(a))}).length.toString()].price:h,this.iconRow=e[1],this.iconLink=y(null!==(n=e[2])&&void 0!==n?n:Ka.iconLink),Game.Tiers[this.keyName]=this,wa.push(this)}}(),ya=[],za=function(b){function a(c,d,e){var g=b.call(this,c,d,G(e))||this;return fa(g,f(g)),ya.push(g),g.won&&Game.CountsAsAchievementOwned(g.pool)&&Game.AchievementsOwned++,g}return aa(a,b),a}(Game.Achievement),Aa=function(b){function a(c,d,e,f){void 0===f&&(f=H(10,O(1.5*Game.BankAchievements.length+2)));var g=b.call(this,c,"Bake <b>"+toFixed(f)+"</b> cookie"+(1===N(f)?"":"s")+" in one ascension."+(e?"<q>"+e+"</q>":""),d)||this;return g.treshold=f,g.order=100+.01*Game.BankAchievements.length,Game.BankAchievements.push(g),g}return aa(a,b),a}(za),Ba=function(b){function a(c,d,e,f){void 0===f&&(f=H(10,O(1.2*Game.BankAchievements.length)));var g=b.call(this,c,"Bake <b>"+toFixed(f)+"</b> cookie"+(1===N(f)?"":"s")+" per second."+(e?"<q>"+e+"</q>":""),d)||this;return g.treshold=f,g.order=200+.01*Game.CpsAchievements.length,Game.CpsAchievements.push(g),g}return aa(a,b),a}(za),Ca=function(b){function a(c,e,f,g){var a=this,h="object"==typeof f?f:Game.Objects[f],i=null,j=-1;if(0===h.id){switch(g){case"cursor2":i=[0,6],j=2;break;case"cursor50":i=[1,6],j=50;break;default:if(0>=Game.Tiers[g].achievUnlock){console.warn("Tier has invalid unlock amount");break}j=1===g?1:2*Game.Tiers[g].achievUnlock;}Ka.buildingHooks.Cursor.on("buy",function(){Game.Objects.Cursor.amount>=j&&Game.Win(a.name)})}else j=Game.Tiers[g].achievUnlock;return a=b.call(this,c,"Have <b>"+j+"</b> "+(1===N(j)?h.single:h.plural)+"."+(e?"<q>"+e+"</q>":""),null!==i&&void 0!==i?i:Game.GetIcon(h.name,g))||this,Game.SetTier(h.name,"cursor2"===g||"cursor50"===g?1:g),h.tieredAchievs[g]=a,a.buildingTie=h,a.order=1e3+100*h.id+a.id/1e3,a.order-=75*D(0,F(h.id-4,3)),8<=h.id&&(a.order-=75),0===h.id&&(a.order+=50),a}return aa(a,b),a}(za),Da=function(b){function a(c,e,f,g,a){var h=this;"string"==typeof e&&(e=Game.Objects[e]);var j=[e.iconColumn,21+f,e instanceof ia?e.iconLink:void 0],k=H(10,12+e.id+(null!==a&&void 0!==a?a:0)+7*(f-1));return h=b.call(this,c,"Make <b>"+toFixed(k)+"</b> cookies just from "+e.plural+"."+(g?"<q>"+g+"</q>":""),j)||this,h.order=1020+100*e.id+h.id/1e3,h.order-=75*D(0,F(e.id-4,3)),8<=e.id&&(h.order-=75),0===e.id&&(h.order+=50),e.productionAchievs.push({pow:k,achiev:h}),h}return aa(a,b),a}(za),Ea=function(b){function a(c,d,e){var f=this;"string"==typeof d&&(d=Game.Objects[d]);var g=[d.iconColumn,26,d instanceof ia?d.iconLink:void 0];return f=b.call(this,c,"Reach level <b>10</b> "+d.plural+"."+(e?"<q>"+e+"</q>":""),g)||this,f.order=1020+100*d.id+f.id/1e3,f.order-=75*D(0,F(d.id-4,3)),8<=d.id&&(f.order-=75),0===d.id&&(f.order+=50),d.levelAchiev10=f,f}return aa(a,b),a}(za),Fa=function(b){function a(c,d,e){var f=this,g=parseInt(d.toString());return f=b.call(this,c,"Make <b>"+toFixed(H(10,1+2*g))+"</b> cookies from clicking."+(e?"<q>"+e+"</q>":""),Game.GetIcon("Mouse",d))||this,f.pool="normal",f.tier=d,f.order=1e3+f.id/1e3,Game.Tiers[d].special||isNaN(g)||Ka.on("check",function(){Game.handmadeCookies>=H(10,1+2*g)&&Game.Win(f.name)}),f}return aa(a,b),a}(za),Ga=function(){function a(a,b,c){this.name=a,this.desc=b,"string"==typeof c&&(c=Game.Objects[c]),this.pic=c instanceof Game.Object?G([c.iconColumn,25,c instanceof ia?c.iconLink:void 0]):c,Game.dragonAuras[Object.keys(Game.dragonAuras).length]=this,"sync"!==U.dragon.auras[0]&&Object.keys(Game.dragonAuras).length>=U.dragon.auras[0]&&(Game.dragonAura=U.dragon.auras[0]),"sync"!==U.dragon.auras[1]&&Object.keys(Game.dragonAuras).length>=U.dragon.auras[1]&&(Game.dragonAura2=U.dragon.auras[1])}return a}(),Ha=function(){function b(c,e,f,g,a,h,i){void 0===i&&(i=Game.dragonLevels.length-3),this.buy=a,this.picY=0;var j=Game.dragonLevels[i-1];this.name=null!==c&&void 0!==c?c:j.name,this.action=e,this.costStr="string"==typeof f?function(){return f}:f,this.cost=g,h?(this.pic=h[0],this.picY=h[1],0!==this.picY&&console.warn("For now, all dragon levels must not use pic Y, sorry."),this.picLink=h[2]):(this.pic=j.pic,j instanceof b&&(this.picY=j.picY,this.picLink=j.picLink)),Game.dragonLevels.splice(i,0,this),"sync"!==U.dragon.level&&Game.dragonLevels.length>=U.dragon.level&&(Game.dragonLevel=U.dragon.level)}return b}(),Ia=function(b){function a(c,d,e){var f=this;return"string"==typeof e&&(e=Game.Objects[e]),f=b.call(this,null,"Train "+c+"<br/><small>Aura : "+d+"</small>","100 "+e.plural,function(){return 100<=e.amount},function(){return e.sacrifice(100)})||this,f}return aa(a,b),a}(Ha),Ja=function(){return function(a,b,c,e){if(void 0===e&&(e=!1),this.name=a,this.pic=c,this.special=e,!c.endsWith(".png"))throw new Error("Can't create milk with the milk URL \""+c+"\", the URL must end with .png!");e||(this.name="Rank "+d(Game.Milks.length+1)+" - "+a),this.pic=c.substr(0,c.length-4),G(b),this.icon=[b[0],b[1]],this.iconLink=b[2],e?Game.MilksByChoice[Object.keys(Game.MilksByChoice).length]=this:Game.Milks.push(this)}}(),Ka={hooks:null,on:null,hiddenMilkMult:1,iconLink:"",buildingLink:"",cookieOrder:10020,buildingHooks:_,buildingHooksById:[],hookAllBuildings:B,customBuildings:ha,customUpgrades:ja,customTiers:wa,save:U,onLoad:[],Building:ia,Upgrade:ka,TieredUpgrade:ma,Tier:xa,HeavenlyUpgrade:la,GrandmaSynergy:na,SynergyUpgrade:oa,CursorUpgrade:qa,KittenUpgrade:ta,MouseUpgrade:ua,CookieUpgrade:va,Achievement:za,CpsAchievement:Ba,BankAchievement:Aa,TieredAchievement:Ca,ProductionAchievement:Da,Level10Achievement:Ea,MouseAchievement:Fa,customAchievements:ya,DragonAura:Ga,DragonLevel:Ha,DragonAuraLevel:Ia,Milk:Ja,injectCode:o,injectCodes:r,DEFAULT_ONBUY:function(){Game.UnlockTiered(this),this.amount>=Game.SpecialGrandmaUnlock&&0<Game.Objects.Grandma.amount&&this.grandma&&Game.Unlock(this.grandma.name)},DEFAULT_CPS:function(a){return Game.GetTieredCpsMult(a)*Game.magicCpS(a.name)*a.baseCps},icons:{relinkColumn:function(b,e,a,f){return void 0===f&&(f=!1),ba(this,void 0,void 0,function(){var g,h,h,j,k;return ca(this,function(c){switch(c.label){case 0:for(h in void 0===a&&(!Y[b]&&(Y[b]=0),a=Y[b]++),g={},z)g[h]=[a,z[h][1]];for(h in Game.Tiers)g[Game.Tiers[h].name.toLowerCase()]=g[h.toString()]=[a,Game.Tiers[h].iconRow];return j=w,k=[b],[4,C(f?y(b):b,g,e,[48,48],[48*(a+1),48*(Object.values(g).reduce(function(a,b){return D(a,b[1])},-Infinity)+1)],function(a){return new Promise(function(c){if(y(b)!==b){var d=new Image;d.addEventListener("load",function(){a.drawImage(d,0,0),c()}),d.src=y(b),d.crossOrigin="Anonymous"}else c()})})];case 1:return j.apply(void 0,k.concat([c.sent()])),[2];}})})},relinkRow:function(b,e,a,f){return void 0===f&&(f=!1),ba(this,void 0,void 0,function(){var g,h,h,j,k;return ca(this,function(c){switch(c.label){case 0:for(h in void 0===a&&(!Z[b]&&(Z[b]=0),a=Z[b]++),g={},$)g[h]=[$[h][0],a];for(h in Game.ObjectsById)g[Game.ObjectsById[h].single.toLowerCase()]=g[h]=[Game.ObjectsById[h].iconColumn,a];return j=w,k=[b],[4,C(f?y(b):b,g,e,[48,48],[48*(Object.values(g).reduce(function(a,b){return D(a,b[0])},-Infinity)+1),48*(a+1)],function(a){return new Promise(function(c){if(y(b)!==b){var d=new Image;d.addEventListener("load",function(){a.drawImage(d,0,0),c()}),d.src=y(b),d.crossOrigin="Anonymous"}else c()})})];case 1:return j.apply(void 0,k.concat([c.sent()])),[2];}})})},patchIconsheet:function(j,e,i){var q;return void 0===i&&(i=!0),ba(this,void 0,void 0,function(){var a,r,x,z,B,D,E,F,G,H,J,K,L,M,N;return ca(this,function(b){switch(b.label){case 0:return a=document.createElement("canvas").getContext("2d"),[4,A(i?y(j):j)];case 1:for(r=b.sent(),x=[r.width,r.height],z=0,B=e;z<B.length;z++)D=B[z],48*D[0][0]>x[0]&&(x[0]=48*D[0][0]),48*D[0][1]>x[1]&&(x[1]=48*D[0][1]);a.canvas.width=x[0],a.canvas.height=x[1],a.drawImage(r,0,0),E={},F=0,G=e,b.label=2;case 2:return F<G.length?(H=G[F],J=y((null!==(q=H[1][2])&&void 0!==q?q:Ka.iconLink)||"img/icons.png"),!!E[J])?[3,4]:(K=E,L=J,[4,A(J)]):[3,6];case 3:K[L]=b.sent(),b.label=4;case 4:a.clearRect(48*H[0][0],48*H[0][1],48,48),a.drawImage(E[J],48*H[1][0],48*H[1][1],48,48,48*H[0][0],48*H[0][1],48,48),b.label=5;case 5:return F++,[3,2];case 6:return M=w,N=[j],[4,I(a)];case 7:return M.apply(void 0,N.concat([b.sent()])),[2];}})})},extraColumnIcons:z,extraRowIcons:$,alias:w,aliases:V}};window.Cppkies?x=window.Cppkies:(x=Ka,window.Cppkies=x,function(){return new Promise(function(a){var b=new R,c=[new S("customMenu",function(){Game.UpdateMenu=o(Game.UpdateMenu,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tswitch (Game.onMenu) {\n\t\t\t\t\t\tcase \"prefs\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"optionsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"stats\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"statsMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\t\tCppkies.hooks.emit(\"logMenu\")\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tCppkies.hooks.emit(\"menu\")\n\t\t\t\t\t","after")}),new S("preSave",function(){Game.WriteSave=o(Game.WriteSave,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"preSave\")\n\t\t\t\t\t","before")}),new S("postSave",function(){Game.WriteSave=o(Game.WriteSave,"if (type==2 || type==3)","\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.emit(\"postSave\")\n\t\t\t\t\t","before")}),new S("reset",function(){Game.Reset=o(Game.Reset,null,"\n\t\t\t\t\t// Cppkies injection\n\t\t\t\t\tCppkies.hooks.constEmit(\"reset\", hard)\n\t\t\t\t\t","before")}),new S("reincarnate",function(){Game.registerHook("reincarnate",function(){return b.emit("reincarnate")})}),new S("getIcon",function(){Game.GetIcon=r(Game.GetIcon,[["return [col,Game.Tiers[tier].iconRow];","// Cppkies Injection\n\t\t\t\t\treturn Cppkies.hooks.emit(\"getIcon\", { icon: [col, Game.Tiers[tier].iconRow], tier: tier, type: type }).icon","replace"],["col=18;","else if (type === \"Mouse\") col = 11;","after"]])}),new S("buildStore",function(){Game.BuildStore=o(Game.BuildStore,null,";\nCppkies.hooks.emit(\"buildStore\")","after")}),new S("grandmaPic",function(){Game.Objects.Grandma.art.pic=o(Game.Objects.Grandma.art.pic,"return choose(list)+'.png'","// Cppkies injection\n\t\t\t\t\tlist = Cppkies.hooks.emit(\"grandmaPic\", list)\n\t\t\t\t\t","before")}),new S("cps",function(){Game.CalculateGains=r(Game.CalculateGains,[["var rawCookiesPs=Game.cookiesPs*mult;","// Cppkies injection\n\t\t\t\t\tGame.cookiesPs = Cppkies.hooks.emit(\"rawCps\", Game.cookiesPs);\n\t\t\t\t\tmult = Cppkies.hooks.emit(\"rawCpsMult\", mult);\n","before"],["Game.cookiesPs=Game.runModHookOnValue('cps',Game.cookiesPs);","// Cppkies injection\n\t\t\t\t\t\tmult = Cppkies.hooks.emit(\"cpsMult\", mult);\n","before"]]),Game.registerHook("cps",function(a){return b.emit("cps",a)})}),new S("cursorFingerMult",function(){Game.Objects.Cursor.cps=o(Game.Objects.Cursor.cps,"var mult=1;","// Cppkies injection\nadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before")}),new S("cpc",function(){Game.mouseCps=r(Game.mouseCps,[["var num=0;","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cursorFingerMult\", add);\n","before"],["var out","// Cppkies injection\n\t\t\t\t\t\tadd = Cppkies.hooks.emit(\"cpcAdd\", add);\n","before"]]),Game.registerHook("cookiesPerClick",function(a){return b.emit("cpc",a)})}),new S("buildingCps",function(){Game.CalculateGains=o(Game.CalculateGains,"me.storedTotalCps=me.amount*me.storedCps;","// Cppkies injection (internal, do not use)\nme.storedCps = Cppkies.hooks.emit(\"buildingCps\", { building: i, cps: me.storedCps }).cps;\n","before")}),new S("logic",function(){Game.registerHook("logic",function(){return b.emit("logic")})}),new S("draw",function(){Game.registerHook("draw",function(){return b.emit("draw")})}),new S("check",function(){Game.registerHook("check",function(){return b.emit("check")})}),new S("ticker",function(){Game.getNewTicker=o(Game.getNewTicker,"Game.TickerAge=Game.fps*10;","// Cppkies injection\nlist = Cppkies.hooks.emit(\"ticker\", list);\n","before")}),new S("specialPic",function(){Game.DrawSpecial=o(Game.DrawSpecial,"if (hovered || selected)","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTabs[i], frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","before"),Game.ToggleSpecialMenu=o(Game.ToggleSpecialMenu,"else {pic='dragon.png?v='+Game.version;frame=4;}","// Cppkies injection\nconst override = Cppkies.hooks.emit(\"specialPic\", {tab: Game.specialTab, frame: frame, pic: pic})\npic = override.pic\nframe = override.frame;\n","after")})];c.forEach(function(a){var b;null===(b=a.func)||void 0===b?void 0:b.call(a)}),Game.Loader.Load=o(Game.Loader.Load,"img.src=this.domain","\n\t\t\t// Cppkies injection\n\t\t\timg.src = (assets[i].indexOf('http') !== -1 ? \"\" : this.domain)\n","replace"),Game.UpdateMenu=r(Game.UpdateMenu,[["url(img/'+milk.pic+'.png)","url(' + (milk.pic.indexOf('http') >= 0 ? milk.pic : 'img/'+milk.pic) + '.png)","replace"],["img/icons.png?v='+Game.version+'","' + (Game.Milks[i].iconLink ? Game.Milks[i].iconLink : 'img/icons.png?v='+Game.version) + '","replace"]]),Game.ToggleSpecialMenu=r(Game.ToggleSpecialMenu,[[">=5",">=Game.dragonLevels.findIndex(val => val.name === \"Krumblor, cookie hatchling\")","replace"],[">=25",">=Game.dragonLevels.findIndex(val => val.action === \"Train secondary aura<br><small>Lets you use two dragon auras simultaneously</small>\") + 1","replace"]]),Game.Objects.Cursor.buyFunction=o(Game.Objects.Cursor.buyFunction,"Game.Unlock('Octillion fingers');","\n \t\t\t// Cppkies injection\n\t\t\tfor(const i in this.tieredUpgrades) {\n\t\t\t\tif (isNaN(parseInt(i))) continue\n\t\t\t\tif (this.amount >= Game.Tiers[this.tieredUpgrades[i].tier].unlock - 50) this.tieredUpgrades[i].unlock()\n\t\t\t}\n","after"),Game.Object=o(Game.Object,"Game.ObjectsN++","\n// Cppkies injection\nCppkies.hookAllBuildings();\n","after"),Game.CalculateGains=o(Game.CalculateGains,"var catMult=1;","// Cppkies injection\n\t\t\tCppkies.hiddenMilkMult = milkMult;\n","before"),a(b)})}().then(function(a){x.hooks=a,x.on=a.on.bind(a),Game.Notify("Cppkies loaded!","",[32,17],1.5);var b=document.createElement("div");b.textContent="Cppkies!",document.querySelector("#topBar").insertBefore(b,document.querySelector("#topBar").children[1]),Game.modSaveData.cppkies||(Game.modSaveData.cppkies="{}"),Game.registerMod("cppkies",{save:v,load:j}),Game.Win("Third-party"),B(),Ka.onLoad.forEach(function(a){return a()}),Ka.onLoad=new Proxy(Ka.onLoad,{set:function(a,b,c){return"length"!==b&&c(),!0}}),window.CPPKIES_ONLOAD||(window.CPPKIES_ONLOAD=[]),window.CPPKIES_ONLOAD.forEach(function(a){return a()}),window.CPPKIES_ONLOAD=new Proxy(Ka.onLoad,{set:function(a,b,c){return"length"!==b&&c(),!0}}),E()}));var La=x;return La})});let e=[];class f{constructor(a,b,c){this.name=a,this.color=b,this.tagFunction=c,e.push([this.name,this.color,this.tagFunction])}}class g extends d.Achievement{constructor(a,b,c){super(a,b,c)}}new f("Author","#ffffff",a=>"authors"===a.pool);class h extends d.Upgrade{constructor(a,b,c,d,e){super(a,b,c,d,e)}}class i extends d.HeavenlyUpgrade{constructor(a,b,c,d,e,f,g){super(a,b,c,d,[e[0],e[1]],f,g)}}class j extends Game.buffType{constructor(a,b){super(a,b)}}class k extends i{constructor(a,b,c,d,e,f,g,h){super(a,b,c,f,d,g,h),"undefined"==typeof window.SkullyCore.pages[e]&&(window.SkullyCore.pages[e]=[]),window.SkullyCore.pages[e].push(this),"vanilla"!==e&&Game.PrestigeUpgrades.pop()}}class m extends k{constructor(a,b,c,d,e,f=[1,2,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"],g,h){super(a,b,0,c,e,f,g,h),this.isRift=!0,this.activateFunction=()=>{window.SkullyCore.currentPage=this.goto,Game.BuildAscendTree()},this.exclude={all:!0},this.back=e,this.noTags=!0,this.unlocked=1,this.bought=1,this.noNeuromancy=!0,this.goto=d}}new f("Rift","#9700cf",a=>"undefined"!=typeof a.isRift);class n{}class o extends n{constructor(a,b,c){super(),this._hidden=!1,this.id=a,this.icon=b,this.tooltip=c,this.index=window.SkullyCore.BarWidgets.TopBar.Bars.push(this)-1}getDiv(){window.SkullyCore.BarWidgets.TopBar.currentPos+=48;let c=a(`
        <div class="top_bar" style="left:${window.SkullyCore.BarWidgets.TopBar.currentPos}px;" id="${this.id}TopBarMenu"> 
            <div id="${this.id}TopBarMenuIcon" class="baseIcon ${"undefined"==typeof this.icon[2]?"usesIcon":""}" style="${b(this.icon)}"></div>
        </div>`);return"undefined"!=typeof this.onclick&&(c.onclick=this.onclick),"undefined"!=typeof this.tooltip&&(c.onmouseout=()=>{Game.tooltip.shouldHide=1},c.setAttribute("onmouseover",`let ${this.id}TopBarMenuTooltip = ${this.tooltip.toString()};Game.tooltip.dynamic=1;Game.tooltip.draw(this,function(){return ${this.id}TopBarMenuTooltip();},'bottom');Game.tooltip.wobble();`)),"undefined"!=typeof this.customDiv&&(c=this.customDiv(c)),this.hidden&&(c.style.display="none"),c}set hidden(a){this._hidden=a,"undefined"!=typeof this.div&&(this.div.style.display=a?"block":"none",window.SkullyCore.TopBarMenuWidget.reloadPlacement())}get hidden(){return this._hidden}static reloadPlacement(){window.SkullyCore.BarWidgets.TopBar.currentPos=12;for(let a of window.SkullyCore.BarWidgets.TopBar.Bars)!0!==a.hidden&&(window.SkullyCore.BarWidgets.TopBar.currentPos+=48,a.div.removeAttribute("style"),a.div.setAttribute("style",`left:${window.SkullyCore.BarWidgets.TopBar.currentPos}px;`))}}class p extends n{constructor(a,b,c,d){super(),this._hidden=!1,this.id=a,this.icon=b,this.building=c,this.tooltip=d,"undefined"==typeof window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building]&&(window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building]=[],window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]=-36),this.index=window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building].push(this)-1}getDiv(){window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]+=48;let b=a(`
        <div class="building_bar" style="left:${window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]}px;" id="${this.id}BuildingBarMenu"> 
            <div id="${this.id}BuildingBarMenuIcon" class="baseIcon ${"undefined"==typeof this.icon[2]?"usesIcon":""}" style="${"undefined"==typeof this.icon[2]?"":"background-image:url("+this.icon[2]+");"}background-position:${48*-this.icon[0]}px ${48*-this.icon[1]}px;"></div>
        </div>`);return"undefined"!=typeof this.onclick&&(b.onclick=this.onclick),"undefined"!=typeof this.tooltip&&(b.onmouseout=()=>{Game.tooltip.shouldHide=1},b.setAttribute("onmouseover",`let ${this.id}BuildingBarMenuTooltip = ${this.tooltip.toString()};Game.tooltip.dynamic=1;Game.tooltip.draw(this,function(){return ${this.id}BuildingBarMenuTooltip();},'bottom');Game.tooltip.wobble();`)),"undefined"!=typeof this.customDiv&&(b=this.customDiv(b)),this.hidden&&(b.style.display="none"),b}set hidden(a){this._hidden=a,"undefined"!=typeof this.div&&(this.div.style.display=a?"block":"none",this.reloadPlacement())}get hidden(){return this._hidden}reloadPlacement(){window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]=-36;for(let a of window.SkullyCore.BarWidgets.BuildingBar.Bars[this.building])!0!==a.hidden&&(window.SkullyCore.BarWidgets.BuildingBar.currentPos[this.building]+=48,a.div.removeAttribute("style"),a.div.setAttribute("style",`left:${window.SkullyCore.BarWidgets.TopBar.currentPos}px;`))}}const q={AdvancedAchievement:g,AdvancedHeavenlyUpgrade:i,AdvancedUpgrade:h,AuthorAchievement:class extends g{constructor(a,b,c){super(a,b,c),this.pool="authors",this.exclude={shadow:!0},this.won=1,this.noTags=!0,this.noNeuromancy=!0}},TagCondition:f,TagConditions:e,PrestigePage:class{constructor(a,b,c,d,e){this.name=a,this.id=b,this.Rift=new m("Goto "+this.name+"...","Goto a new universe of possiblities. Don't worry you can come back.",[-30,-130],this.id,"vanilla",d,c),this.VanillaRift=new m("Goto Vanilla...","Takes you back to the vanilla prestige tree.",[-30,-30],"vanilla",this.id,e)}},RiftUpgrade:m,PagedHeavenlyUpgrade:k,currentPage:"vanilla",pages:{vanilla:Game.PrestigeUpgrades},TopBarMenuWidget:o,BuildingBarMenuWidget:p,BarWidgets:{TopBar:{currentPos:12,Bars:[]},BuildingBar:{currentPos:{},Bars:{}}},Task:class extends j{constructor(a,b){super(a,b)}},ActiveTasks:[],onLoad:[],exclude:function(a,b){if("undefined"!=typeof b.exclude){if("undefined"!=typeof b.exclude.all&&!b.exclude.all)return!0;switch(a){case"total":if("undefined"!=typeof b.exclude.total&&!b.exclude.total)return!0;break;case"debug":if("undefined"!=typeof b.exclude.debug&&!b.exclude.total)return!0;break;case"prestige":if("undefined"!=typeof b.exclude.total&&!b.exclude.total)return!0;break;case"cookie":if("undefined"!=typeof b.exclude.cookie&&!b.exclude.cookie)return!0;break;case"other":if("undefined"!=typeof b.exclude.other&&!b.exclude.other)return!0;break;case"shadow":if("undefined"!=typeof b.exclude.shadow&&!b.exclude.shadow)return!0;}}else return!0;return!1},IconToStyle:b,createElementFromString:a};let r;"undefined"==typeof window.SkullyCore?(window.SkullyCore=q,r=q,d.onLoad.push(()=>{Game.UpdateMenu=d.injectCodes(Game.UpdateMenu,[[`for (var i in achievements)`,`pools.authors = "<b>Authors</b> <small>The people who made the mods you are playing with now!</small>";`,"before"]]),Game.crate=d.injectCodes(Game.crate,[[`if (neuromancy)`,`if (neuromancy && (typeof me.noNeuromancy !== "undefined" ? !me.noNeuromancy : true))`,"replace"]]),Game.crateTooltip=d.injectCodes(Game.crateTooltip,[[`var tagsStr='';`,`
            if (typeof me.noTags !== "undefined" ? me.noTags : false) tags = []
            if (typeof me.tags !== "undefined") {
                for(let i in me.tags) {
                    tags.concat(me.tags[i]);
                }
            }
            if (typeof window.SkullyCore !== "undefined") window.SkullyCore.TagConditions.forEach((element) => {
                if(typeof element[2] === "function") {
                    if(element[2](me)) tags.push(element[0], element[1]) 
                } else if (typeof element[2] === "boolean") {
                    if(element[2]) tags.push(element[0], element[1])
                } else {
                    console.warn("Malformed TagCondition")
                }
            })
            `,"before"]]),Game.UpdateMenu=d.injectCodes(Game.UpdateMenu,[[`if (me.pool=='' || me.pool=='cookie' || me.pool=='tech') upgradesTotal++;`,`if (me.pool=='' || me.pool=='cookie' || me.pool=='tech' ) {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("total", me)) {
                    upgradesTotal++
                }
            }
            `,"replace"],[`if (me.pool=='debug') hiddenUpgrades+=str2;`,`if (me.pool=='debug') { 
                // SkullyCore Inject
                if (window.SkullyCore.exclude("debug", me)) {
                    hiddenUpgrades+=str2;
                }
            }`,"replace"],[`else if (me.pool=='prestige') {prestigeUpgrades+=str2;prestigeUpgradesTotal++;}`,`else if (me.pool=='prestige') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("prestige", me)) {
                    prestigeUpgrades+=str2;
                    prestigeUpgradesTotal++;
                }
            }`,"replace"],[`else if (me.pool=='prestige') prestigeUpgradesOwned++;`,`else if (me.pool=='prestige') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("prestige", me)) {
                    prestigeUpgradesOwned++;
                }
            }`,"replace"],[`else if (me.pool=='cookie') cookieUpgrades+=str2;`,`else if (me.pool=='cookie') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("cookie", me)) {
                    cookieUpgrades+=str2;
                }
            }`,"replace"],[`else if (me.pool!='toggle' && me.pool!='unused') upgrades+=str2;`,`else if (me.pool!='toggle' && me.pool!='unused') {
                // SkullyCore Inject
                if (window.SkullyCore.exclude("other", me)) {
                    upgrades+=str2;
                }
            }`,"replace"],[`achievementsOwnedOther++;`,`if (window.SkullyCore.exclude("shadow", me)) {
                // SkullyCore Inject
                achievementsOwnedOther++;
            }`,"replace"]]),Game.BuildAscendTree=d.injectCodes(Game.BuildAscendTree,[[`for (var i in Game.PrestigeUpgrades)`,`for (var i in window.SkullyCore.pages[window.SkullyCore.currentPage])`,"replace"],[`var str='';`,`var currentHeavenlyUpgrades = window.SkullyCore.pages[window.SkullyCore.currentPage];\n`,"before"],[`Game.PrestigeUpgrades`,`currentHeavenlyUpgrades`,"replace"]]),document.getElementsByTagName("head")[0].appendChild(a(`
        <style type="text/css">
            .top_bar { 
                width:32px;
                height:32px;
                position:absolute;
                bottom:-12px;
                z-index:10000;
                filter:drop-shadow(0px 3px 2px #000);
                -webkit-filter:drop-shadow(0px 3px 2px #000);
                cursor:pointer;
            }
            .top_bar:hover {
                bottom:-10px
            }
    
            .building_bar { 
                width:32px;
                height:32px;
                position:absolute;
                bottom:-12px;
                z-index:10000;
                filter:drop-shadow(0px 3px 2px #000);
                -webkit-filter:drop-shadow(0px 3px 2px #000);
                cursor:pointer;
            }
    
            .building_bar:hover {
                bottom:-10px
            }
    
            .baseIcon {
                width:48px;
                height:48px;
                position:absolute;
                left:-8px;
                top:-8px;
            }
        </style>`));for(let a of q.onLoad)a();let b=l("comments");q.BarWidgets.TopBar.Bars.forEach(a=>{a.div=b.appendChild(a.getDiv())}),q.TopBarMenuWidget.reloadPlacement(),Game.ObjectsById.forEach(a=>{let b=l("row"+a.id);null!==b&&("undefined"==typeof q.BarWidgets.BuildingBar.Bars[a.name]&&(q.BarWidgets.BuildingBar.Bars[a.name]=[]),0<q.BarWidgets.BuildingBar.Bars[a.name].length&&(q.BarWidgets.BuildingBar.Bars[a.name].forEach(a=>{a.div=b.appendChild(a.getDiv())}),q.BarWidgets.BuildingBar.Bars[a.name][0].reloadPlacement()))})}),q.onLoad.push(()=>{new q.AuthorAchievement("Orteil & Opti","The people who made this awesome game!",[17,5,""]),new q.AuthorAchievement("TheGLander","The developer of Cppkies and the CCRepo (W.I.P) ",[3,2,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"]),new q.AuthorAchievement("TheSkullyKO","The ideas guy and artist for SkullyCore and other Skully mods",[1,0,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"]),new q.AuthorAchievement("Bob","The developer that made this menu for authors and hopefully will work on much more.",[2,2,"https://raw.githubusercontent.com/MasterOfBob777/SkullyCore/master/static/skullyCoreIcons.png"]),console.log("SkullyCore Loaded!")})):r=window.SkullyCore;var s=r;return s});
//# sourceMappingURL=index.js.map
